---
title: "merge_data_youtube_google"
format: html
---

<br>

```{r}

#  Perform the full join
combined_data <- full_join(aggregated_youtube_data_final, trends_long, 
                           by = c("trending_date" = "date", "country", "keyword"))

# Because every day there is a google trend index, but not every day for each tag there is trendy videos
# Replace NA values with 0 for all columns except the keywords
# This handles the days with no trending videos
combined_data_filled_na <- combined_data %>%
  mutate(across(-c(trending_date, country, keyword), ~replace_na(., 0)))

# Add the status column to indicate if a video was trending
combined_data_final <- combined_data_filled_na %>%
  mutate(youtube_status = if_else(total_views == 0,
                                  "no trending video today for this keyword",
                                  "trending video(s) found"))

# Check your final merged dataset
View(combined_data_final)
colnames(combined_data_final)
```
<br>